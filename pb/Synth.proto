syntax = "proto3";
package m2.pb;

import "Rational.proto";

enum SoundWaveShape {
    SINE = 0;
    SQUARE = 1;
    TRIANGLE = 2;
    SAWTOOTH = 3;
    NOISE = 4;
}

message SynthSound {
    SoundWaveShape shape = 1;
    Rational fraction_of_cycle = 2;  // [0,1), wraps around, used instead of phase
    float amplitude = 3; // [-1, 1], saturates
}

message SynthNote {
    Rational start_beat = 1; // in beats
    Rational duration = 2;   // in beats
    float frequency = 3;     // [0, 24000]
    float volume = 4;        // [0, 1]
}

message SynthTrack {
    SynthSound sound = 1;
    repeated SynthNote notes = 2;
    float volume = 3;
}

message SynthSong {
    uint32 bpm = 1;
    repeated SynthTrack tracks = 2;
}
